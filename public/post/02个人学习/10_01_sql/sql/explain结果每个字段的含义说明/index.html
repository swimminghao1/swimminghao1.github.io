<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>explain结果每个字段的含义说明 | swimminghao</title><meta name=keywords content="mysql"><meta name=description content="explain结果每个字段的含义说明 我们都知道用explain xxx分析sql语句的性能，但是具体从explain的结果怎么分析性能以及每个"><meta name=author content="swimminghao"><link rel=canonical href=https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/><meta name=yandex-verification content="73b1a797f62c0e98"><meta name=baidu-site-verification content="code-gnOrbP1RyC"><meta name=baidu_union_verify content="4c552c344295cb984c46ebe74962b067"><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/satouriko/LxgwWenKai_Webfonts@v1.101/dist/LXGWWenKai-Light.css><link crossorigin=anonymous href=/assets/css/stylesheet.min.0a5d9aa21e56d0b7d41b1d4b56af0b911caf526faf5060a8d3717579bf27cb93.css integrity="sha256-Cl2aoh5W0LfUGx1LVq8LkRyvUm+vUGCo03F1eb8ny5M=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.swimminghao.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.swimminghao.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.swimminghao.top/favicon-32x32.png><link rel=apple-touch-icon href=https://www.swimminghao.top/apple-touch-icon.png><link rel=mask-icon href=https://www.swimminghao.top/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.97.0"><link rel=manifest href=/manifest.json><script type=text/javascript>function downloadJSAtOnload(){var e=document.createElement("script");e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7296634171837358",document.body.appendChild(e)}window.addEventListener?window.addEventListener("load",downloadJSAtOnload,!1):window.attachEvent?window.attachEvent("onload",downloadJSAtOnload):window.onload=downloadJSAtOnload</script><script async defer data-website-id=3d947a98-2774-46b0-805f-fe2e4877a1d7 src=https://umami.frytea.com/umami.js></script>
<script async src=https://www.swimminghao.top/js/busuanzi.pure.mini.js></script>
<link rel=stylesheet href=/libs/font-awesome-4.7.0/css/font-awesome.min.css><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script src=https://www.swimminghao.top/js/mermaid.min.js crossorigin=anonymous></script>
<script>const config={startOnLoad:!0,theme:"forest",themeVariables:{lineColor:"#fafafa"},flowchart:{useMaxWidth:!1,htmlLabels:!0}};mermaid.initialize(config),window.onload=()=>{window.mermaid.init(void 0,document.querySelectorAll(".language-mermaid"))}</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?c49e2f5be5e009382be07455c33b1394",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-136094326-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="explain结果每个字段的含义说明"><meta property="og:description" content="explain结果每个字段的含义说明 我们都知道用explain xxx分析sql语句的性能，但是具体从explain的结果怎么分析性能以及每个"><meta property="og:type" content="article"><meta property="og:url" content="https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/"><meta property="og:image" content="https://www.swimminghao.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-02-28T19:57:47+00:00"><meta property="article:modified_time" content="2022-02-28T19:57:47+00:00"><meta property="og:site_name" content="swimminghao"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.swimminghao.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="explain结果每个字段的含义说明"><meta name=twitter:description content="explain结果每个字段的含义说明 我们都知道用explain xxx分析sql语句的性能，但是具体从explain的结果怎么分析性能以及每个"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.swimminghao.top/post/"},{"@type":"ListItem","position":2,"name":"explain结果每个字段的含义说明","item":"https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"explain结果每个字段的含义说明","name":"explain结果每个字段的含义说明","description":"explain结果每个字段的含义说明 我们都知道用explain xxx分析sql语句的性能，但是具体从explain的结果怎么分析性能以及每个","keywords":["mysql"],"articleBody":"explain结果每个字段的含义说明 我们都知道用explain xxx分析sql语句的性能，但是具体从explain的结果怎么分析性能以及每个字段的含义你清楚吗？这里我做下总结记录，也是供自己以后参考。\n  首先需要注意：MYSQL 5.6.3以前只能EXPLAIN SELECT; MYSQL5.6.3以后就可以EXPLAIN SELECT,UPDATE,DELETE    explain结果示例：\nmysql explain select * from staff; +----+-------------+-------+------+---------------+------+---------+------+------+-------+ | id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra | +----+-------------+-------+------+---------------+------+---------+------+------+-------+ | 1 | SIMPLE | staff | ALL | NULL | NULL | NULL | NULL | 2 | NULL | +----+-------------+-------+------+---------------+------+---------+------+------+-------+ 1 row in set  先上一个官方文档表格的中文版：\n   Column 含义     id 查询序号   select_type 查询类型   table 表名   partitions 匹配的分区   type join类型   prossible_keys 可能会选择的索引   key 实际选择的索引   key_len 索引的长度   ref 与索引作比较的列   rows 要检索的行数(估算值)   filtered 查询条件过滤的行数的百分比   Extra 额外信息    这是explain结果的各个字段，分别解释下含义：\n1. id SQL查询中的序列号。\n id列数字越大越先执行，如果说数字一样大，那么就从上往下依次执行。\n 2. select_type 查询的类型，可以是下表的任何一种类型：\n   select_type 类型说明     SIMPLE 简单SELECT(不使用UNION或子查询)   PRIMARY 最外层的SELECT   UNION UNION中第二个或之后的SELECT语句   DEPENDENT UNION UNION中第二个或之后的SELECT语句取决于外面的查询   UNION RESULT UNION的结果   SUBQUERY 子查询中的第一个SELECT   DEPENDENT SUBQUERY 子查询中的第一个SELECT, 取决于外面的查询   DERIVED 衍生表(FROM子句中的子查询)   MATERIALIZED 物化子查询   UNCACHEABLE SUBQUERY 结果集无法缓存的子查询，必须重新评估外部查询的每一行   UNCACHEABLE UNION UNION中第二个或之后的SELECT，属于无法缓存的子查询    DEPENDENT 意味着使用了关联子查询。\n3. table 查询的表名。不一定是实际存在的表名。 可以为如下的值：\n : 引用id为M和N UNION后的结果。 : 引用id为N的结果派生出的表。派生表可以是一个结果集，例如派生自FROM中子查询的结果。 : 引用id为N的子查询结果物化得到的表。即生成一个临时表保存子查询的结果。  4. type（重要） 这是最重要的字段之一，显示查询使用了何种类型。从最好到最差的连接类型依次为：\n system，const，eq_ref，ref，fulltext，ref_or_null，index_merge，unique_subquery，index_subquery，range，index，ALL\n 除了all之外，其他的type都可以使用到索引，除了index_merge之外，其他的type只可以用到一个索引。\n  1、system   表中只有一行数据或者是空表，这是const类型的一个特例。且只能用于myisam和memory表。如果是Innodb引擎表，type列在这个情况通常都是all或者index\n  2、const   最多只有一行记录匹配。当联合主键或唯一索引的所有字段跟常量值比较时，join类型为const。其他数据库也叫做唯一索引扫描\n  3、eq_ref   多表join时，对于来自前面表的每一行，在当前表中只能找到一行。这可能是除了system和const之外最好的类型。当主键或唯一非NULL索引的所有字段都被用作join联接时会使用此类型。\neq_ref可用于使用’=‘操作符作比较的索引列。比较的值可以是常量，也可以是使用在此表之前读取的表的列的表达式。\n 相对于下面的ref区别就是它使用的唯一索引，即主键或唯一索引，而ref使用的是非唯一索引或者普通索引。 eq_ref只能找到一行，而ref能找到多行。\n   4、ref   对于来自前面表的每一行，在此表的索引中可以匹配到多行。若联接只用到索引的最左前缀或索引不是主键或唯一索引时，使用ref类型（也就是说，此联接能够匹配多行记录）。\nref可用于使用’=‘或’‘操作符作比较的索引列。\n  5、 fulltext   使用全文索引的时候是这个类型。要注意，全文索引的优先级很高，若全文索引和普通索引同时存在时，mysql不管代价，优先选择使用全文索引\n  6、ref_or_null   跟ref类型类似，只是增加了null值的比较。实际用的不多。\neg. SELECT * FROM ref_table WHERE key_column=expr OR key_column IS NULL;   7、index_merge   表示查询使用了两个以上的索引，最后取交集或者并集，常见and ，or的条件使用了不同的索引，官方排序这个在ref_or_null之后，但是实际上由于要读取多个索引，性能可能大部分时间都不如range\n  8、unique_subquery   用于where中的in形式子查询，子查询返回不重复值唯一值，可以完全替换子查询，效率更高。 该类型替换了下面形式的IN子查询的ref： value IN (SELECT primary_key FROM single_table WHERE some_expr)\n  9、index_subquery   该联接类型类似于unique_subquery。适用于非唯一索引，可以返回重复值。\n  10、range   索引范围查询，常见于使用 =, , , =, , BETWEEN, IN()或者like等运算符的查询中。\nSELECT * FROM tbl_name  WHERE key_column BETWEEN 10 and 20;  SELECT * FROM tbl_name  WHERE key_column IN (10,20,30);   11、index   索引全表扫描，把索引从头到尾扫一遍。这里包含两种情况： 一种是查询使用了覆盖索引，那么它只需要扫描索引就可以获得数据，这个效率要比全表扫描要快，因为索引通常比数据表小，而且还能避免二次查询。在extra中显示Using index，反之，如果在索引上进行全表扫描，没有Using index的提示。\n# 此表见有一个name列索引。 # 因为查询的列name上建有索引，所以如果这样type走的是index mysql explain select name from testa; +----+-------------+-------+-------+---------------+----------+---------+------+------+-------------+ | id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra | +----+-------------+-------+-------+---------------+----------+---------+------+------+-------------+ | 1 | SIMPLE | testa | index | NULL | idx_name | 33 | NULL | 2 | Using index | +----+-------------+-------+-------+---------------+----------+---------+------+------+-------------+ 1 row in set  # 因为查询的列cusno没有建索引，或者查询的列包含没有索引的列，这样查询就会走ALL扫描，如下： mysql explain select cusno from testa; +----+-------------+-------+------+---------------+------+---------+------+------+-------+ | id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra | +----+-------------+-------+------+---------------+------+---------+------+------+-------+ | 1 | SIMPLE | testa | ALL | NULL | NULL | NULL | NULL | 2 | NULL | +----+-------------+-------+------+---------------+------+---------+------+------+-------+ 1 row in set  # 包含有未见索引的列 mysql explain select * from testa; +----+-------------+-------+------+---------------+------+---------+------+------+-------+ | id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra | +----+-------------+-------+------+---------------+------+---------+------+------+-------+ | 1 | SIMPLE | testa | ALL | NULL | NULL | NULL | NULL | 2 | NULL | +----+-------------+-------+------+---------------+------+---------+------+------+-------+ 1 row in set   12、all   全表扫描，性能最差。\n5. partitions 版本5.7以前，该项是explain partitions显示的选项，5.7以后成为了默认选项。该列显示的为分区表命中的分区情况。非分区表该字段为空（null）。\n6. possible_keys 查询可能使用到的索引都会在这里列出来\n7. key 查询真正使用到的索引。 select_type为index_merge时，这里可能出现两个以上的索引，其他的select_type这里只会出现一个。\n8. key_len 查询用到的索引长度（字节数）。 如果是单列索引，那就整个索引长度算进去，如果是多列索引，那么查询不一定都能使用到所有的列，用多少算多少。留意下这个列的值，算一下你的多列索引总长度就知道有没有使用到所有的列了。\n key_len只计算where条件用到的索引长度，而排序和分组就算用到了索引，也不会计算到key_len中。\n 9. ref 如果是使用的常数等值查询，这里会显示const，如果是连接查询，被驱动表的执行计划这里会显示驱动表的关联字段，如果是条件使用了表达式或者函数，或者条件列发生了内部隐式转换，这里可能显示为func\n10. rows（重要） rows 也是一个重要的字段。 这是mysql估算的需要扫描的行数（不是精确值）。 这个值非常直观显示 SQL 的效率好坏, 原则上 rows 越少越好.\n11. filtered 这个字段表示存储引擎返回的数据在server层过滤后，剩下多少满足查询的记录数量的比例，注意是百分比，不是具体记录数。这个字段不重要\n12. extra（重要） EXplain 中的很多额外的信息会在 Extra 字段显示, 常见的有以下几种内容:\n distinct：在select部分使用了distinc关键字 Using filesort：当 Extra 中有 Using filesort 时, 表示 MySQL 需额外的排序操作, 不能通过索引顺序达到排序效果. 一般有 Using filesort, 都建议优化去掉, 因为这样的查询 CPU 资源消耗大.  # 例如下面的例子:  mysql EXPLAIN SELECT * FROM order_info ORDER BY product_name \\G *************************** 1. row ***************************  id: 1  select_type: SIMPLE  table: order_info  partitions: NULL  type: index possible_keys: NULL  key: user_product_detail_index  key_len: 253  ref: NULL  rows: 9  filtered: 100.00  Extra: Using index; Using filesort 1 row in set, 1 warning (0.00 sec) 我们的索引是  KEY `user_product_detail_index` (`user_id`, `product_name`, `productor`) 但是上面的查询中根据 product_name 来排序, 因此不能使用索引进行优化, 进而会产生 Using filesort. 如果我们将排序依据改为 ORDER BY user_id, product_name, 那么就不会出现 Using filesort 了. 例如:  mysql EXPLAIN SELECT * FROM order_info ORDER BY user_id, product_name \\G *************************** 1. row ***************************  id: 1  select_type: SIMPLE  table: order_info  partitions: NULL  type: index possible_keys: NULL  key: user_product_detail_index  key_len: 253  ref: NULL  rows: 9  filtered: 100.00  Extra: Using index 1 row in set, 1 warning (0.00 sec)  Using index “覆盖索引扫描”, 表示查询在索引树中就可查找所需数据, 不用扫描表数据文件, 往往说明性能不错 Using temporary 查询有使用临时表, 一般出现于排序, 分组和多表 join 的情况, 查询效率不高, 建议优化.  除此之外还有其他值，这里就不一一一列举了。\n 通过以上这些总结，以后我们看到explain的结果，就知道该从哪些字段值去分析sql语句的执行效率了。\n","wordCount":"3504","inLanguage":"zh","datePublished":"2022-02-28T19:57:47Z","dateModified":"2022-02-28T19:57:47Z","author":{"@type":"Person","name":"swimminghao"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/"},"publisher":{"@type":"Organization","name":"swimminghao","logo":{"@type":"ImageObject","url":"https://www.swimminghao.top/favicon.ico"}}}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.swimminghao.top/ accesskey=h title="🍀 swimminghao (Alt + H)">🍀 swimminghao</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://www.swimminghao.top/categories/ title="🗂 归类"><span>🗂 归类</span></a></li><li><a href=https://www.swimminghao.top/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://www.swimminghao.top/archives/ title="⏱️ 时间轴"><span>⏱️ 时间轴</span></a></li><li><a href=https://www.swimminghao.top/search/ title="🔍 索引 (Alt + /)" accesskey=/><span>🔍 索引</span></a></li><li><a href=https://www.swimminghao.top/friends title="🧑‍🤝‍🧑 友链"><span>🧑‍🤝‍🧑 友链</span></a></li><li><a href=https://www.travellings.cn/go.html title=🚇><span>🚇</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.swimminghao.top/>主页</a>&nbsp;»&nbsp;<a href=https://www.swimminghao.top/post/>Posts</a></div><h1 class=post-title><a href=https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/>explain结果每个字段的含义说明</a></h1><div class=post-meta>February 28, 2022&nbsp;·&nbsp;7 分钟&nbsp;·&nbsp;3504 字&nbsp;·&nbsp;swimminghao&nbsp;|&nbsp;<a href=https://github.com/songtianlun/songtianlun.github.io/edit/main/content/post/02%e4%b8%aa%e4%ba%ba%e5%ad%a6%e4%b9%a0/10_01_sql/sql/explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e.md rel="noopener noreferrer" target=_blank>PR</a>
<span>| <span class=waline-pageview-count data-path=/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/><i class="fa fa-spinner fa-spin"></i></span> Hits</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e aria-label=explain结果每个字段的含义说明>explain结果每个字段的含义说明</a><ul><li><a href=#1-id aria-label="1. id">1. id</a></li><li><a href=#2-select_type aria-label="2. select_type">2. select_type</a></li><li><a href=#3-table aria-label="3. table">3. table</a></li><li><a href=#4-type%e9%87%8d%e8%a6%81 aria-label="4. type（重要）">4. type（重要）</a><ul><ul><ul><ul><li><a href=#1system aria-label=1、system>1、system</a></li><li><a href=#2const aria-label=2、const>2、const</a></li><li><a href=#3eq_ref aria-label=3、eq_ref>3、eq_ref</a></li><li><a href=#4ref aria-label=4、ref>4、ref</a></li><li><a href=#5-fulltext aria-label="5、 fulltext">5、 fulltext</a></li><li><a href=#6ref_or_null aria-label=6、ref_or_null>6、ref_or_null</a></li><li><a href=#7index_merge aria-label=7、index_merge>7、index_merge</a></li><li><a href=#8unique_subquery aria-label=8、unique_subquery>8、unique_subquery</a></li><li><a href=#9index_subquery aria-label=9、index_subquery>9、index_subquery</a></li><li><a href=#10range aria-label=10、range>10、range</a></li><li><a href=#11index aria-label=11、index>11、index</a></li><li><a href=#12all aria-label=12、all>12、all</a></li></ul></ul></ul></ul></li><li><a href=#5-partitions aria-label="5. partitions">5. partitions</a></li><li><a href=#6-possible_keys aria-label="6. possible_keys">6. possible_keys</a></li><li><a href=#7-key aria-label="7. key">7. key</a></li><li><a href=#8-key_len aria-label="8. key_len">8. key_len</a></li><li><a href=#9-ref aria-label="9. ref">9. ref</a></li><li><a href=#10-rows%e9%87%8d%e8%a6%81 aria-label="10. rows（重要）">10. rows（重要）</a></li><li><a href=#11-filtered aria-label="11. filtered">11. filtered</a></li><li><a href=#12-extra%e9%87%8d%e8%a6%81 aria-label="12. extra（重要）">12. extra（重要）</a></li></ul></li></ul></div><div><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-7296634171837358 data-ad-slot=9161921641 data-ad-format=auto data-full-width-responsive=true></ins></div><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></details></div><div class=post-content><blockquote style=margin-top:8px><p style=text-align:center;text-indent:0><a href=https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/>本文</a>
首发于
<a href=https://www.swimminghao.top/>🍀 永浩</a>，
<a href=/disclaimer/>转载</a> 请注明
<a href=https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/10_01_sql/sql/explain%E7%BB%93%E6%9E%9C%E6%AF%8F%E4%B8%AA%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%AB%E4%B9%89%E8%AF%B4%E6%98%8E/>来源</a>。</p></blockquote><h1 id=explain结果每个字段的含义说明>explain结果每个字段的含义说明<a hidden class=anchor aria-hidden=true href=#explain结果每个字段的含义说明>#</a></h1><p>我们都知道用<code>explain xxx</code>分析sql语句的性能，但是具体从explain的结果怎么分析性能以及每个字段的含义你清楚吗？这里我做下总结记录，也是供自己以后参考。</p><blockquote><ul><li>首先需要注意：<strong>MYSQL 5.6.3</strong>以前只能<code>EXPLAIN SELECT</code>; MYSQL5.6.3以后就可以<code>EXPLAIN SELECT,UPDATE,DELETE</code></li></ul></blockquote><hr><p>explain结果示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> explain select <span style=color:#f92672>*</span> from staff;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> select_type <span style=color:#f92672>|</span> table <span style=color:#f92672>|</span> type <span style=color:#f92672>|</span> possible_keys <span style=color:#f92672>|</span> key  <span style=color:#f92672>|</span> key_len <span style=color:#f92672>|</span> ref  <span style=color:#f92672>|</span> rows <span style=color:#f92672>|</span> <span style=color:#66d9ef>Extra</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>SIMPLE</span>      <span style=color:#f92672>|</span> staff <span style=color:#f92672>|</span> <span style=color:#66d9ef>ALL</span>  <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>          <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> set
</span></span></code></pre></div><hr><p>先上一个官方文档表格的中文版：</p><table><thead><tr><th>Column</th><th>含义</th></tr></thead><tbody><tr><td>id</td><td>查询序号</td></tr><tr><td>select_type</td><td>查询类型</td></tr><tr><td>table</td><td>表名</td></tr><tr><td>partitions</td><td>匹配的分区</td></tr><tr><td>type</td><td>join类型</td></tr><tr><td>prossible_keys</td><td>可能会选择的索引</td></tr><tr><td>key</td><td>实际选择的索引</td></tr><tr><td>key_len</td><td>索引的长度</td></tr><tr><td>ref</td><td>与索引作比较的列</td></tr><tr><td>rows</td><td>要检索的行数(估算值)</td></tr><tr><td>filtered</td><td>查询条件过滤的行数的百分比</td></tr><tr><td>Extra</td><td>额外信息</td></tr></tbody></table><p>这是explain结果的各个字段，分别解释下含义：</p><h2 id=1-id>1. id<a hidden class=anchor aria-hidden=true href=#1-id>#</a></h2><p>SQL查询中的序列号。</p><blockquote><p>id列数字越大越先执行，如果说数字一样大，那么就从上往下依次执行。</p></blockquote><h2 id=2-select_type>2. select_type<a hidden class=anchor aria-hidden=true href=#2-select_type>#</a></h2><p>查询的类型，可以是下表的任何一种类型：</p><table><thead><tr><th>select_type</th><th>类型说明</th></tr></thead><tbody><tr><td>SIMPLE</td><td>简单SELECT(不使用UNION或子查询)</td></tr><tr><td>PRIMARY</td><td>最外层的SELECT</td></tr><tr><td>UNION</td><td>UNION中第二个或之后的SELECT语句</td></tr><tr><td>DEPENDENT UNION</td><td>UNION中第二个或之后的SELECT语句取决于外面的查询</td></tr><tr><td>UNION RESULT</td><td>UNION的结果</td></tr><tr><td>SUBQUERY</td><td>子查询中的第一个SELECT</td></tr><tr><td>DEPENDENT SUBQUERY</td><td>子查询中的第一个SELECT, 取决于外面的查询</td></tr><tr><td>DERIVED</td><td>衍生表(FROM子句中的子查询)</td></tr><tr><td>MATERIALIZED</td><td>物化子查询</td></tr><tr><td>UNCACHEABLE SUBQUERY</td><td>结果集无法缓存的子查询，必须重新评估外部查询的每一行</td></tr><tr><td>UNCACHEABLE UNION</td><td>UNION中第二个或之后的SELECT，属于无法缓存的子查询</td></tr></tbody></table><p>DEPENDENT 意味着使用了关联子查询。</p><h2 id=3-table>3. table<a hidden class=anchor aria-hidden=true href=#3-table>#</a></h2><p>查询的表名。不一定是实际存在的表名。
可以为如下的值：</p><ul><li>&lt;unionM,N>: 引用id为M和N UNION后的结果。</li><li><derivedn>: 引用id为N的结果派生出的表。派生表可以是一个结果集，例如派生自FROM中子查询的结果。</li><li><subqueryn>: 引用id为N的子查询结果物化得到的表。即生成一个临时表保存子查询的结果。</li></ul><h2 id=4-type重要>4. type（重要）<a hidden class=anchor aria-hidden=true href=#4-type重要>#</a></h2><p>这是<strong>最重要的字段之一</strong>，显示查询使用了何种类型。从最好到最差的连接类型依次为：</p><blockquote><p><strong>system，const，eq_ref，ref，fulltext，ref_or_null，index_merge，unique_subquery，index_subquery，range，index，ALL</strong></p></blockquote><p>除了all之外，其他的type都可以使用到索引，除了index_merge之外，其他的type只可以用到一个索引。</p><ul><li><h6 id=1system>1、system<a hidden class=anchor aria-hidden=true href=#1system>#</a></h6></li></ul><p>表中只有一行数据或者是空表，这是const类型的一个特例。且只能用于myisam和memory表。如果是Innodb引擎表，type列在这个情况通常都是all或者index</p><ul><li><h6 id=2const>2、const<a hidden class=anchor aria-hidden=true href=#2const>#</a></h6></li></ul><p>最多只有一行记录匹配。当联合主键或唯一索引的所有字段跟常量值比较时，join类型为const。其他数据库也叫做唯一索引扫描</p><ul><li><h6 id=3eq_ref>3、eq_ref<a hidden class=anchor aria-hidden=true href=#3eq_ref>#</a></h6></li></ul><p>多表join时，对于来自前面表的每一行，在当前表中只能找到一行。这可能是除了system和const之外最好的类型。当主键或唯一非NULL索引的所有字段都被用作join联接时会使用此类型。</p><p>eq_ref可用于使用&rsquo;=&lsquo;操作符作比较的索引列。比较的值可以是常量，也可以是使用在此表之前读取的表的列的表达式。</p><blockquote><p><strong>相对于下面的ref区别就是它使用的唯一索引，即主键或唯一索引，而ref使用的是非唯一索引或者普通索引。
eq_ref只能找到一行，而ref能找到多行。</strong></p></blockquote><ul><li><h6 id=4ref>4、ref<a hidden class=anchor aria-hidden=true href=#4ref>#</a></h6></li></ul><p>对于来自前面表的每一行，在此表的索引中可以匹配到多行。若联接只用到索引的最左前缀或索引不是主键或唯一索引时，使用ref类型（也就是说，此联接能够匹配多行记录）。</p><p>ref可用于使用&rsquo;=&lsquo;或&rsquo;&lt;=>&lsquo;操作符作比较的索引列。</p><ul><li><h6 id=5-fulltext>5、 fulltext<a hidden class=anchor aria-hidden=true href=#5-fulltext>#</a></h6></li></ul><p>使用全文索引的时候是这个类型。要注意，<strong>全文索引的优先级很高</strong>，若全文索引和普通索引同时存在时，mysql不管代价，优先选择使用全文索引</p><ul><li><h6 id=6ref_or_null>6、ref_or_null<a hidden class=anchor aria-hidden=true href=#6ref_or_null>#</a></h6></li></ul><p>跟ref类型类似，只是增加了null值的比较。实际用的不多。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>eg.
</span></span><span style=display:flex><span>SELECT <span style=color:#f92672>*</span> FROM ref_table
</span></span><span style=display:flex><span>WHERE key_column<span style=color:#f92672>=</span>expr OR key_column IS NULL;
</span></span></code></pre></div><ul><li><h6 id=7index_merge>7、index_merge<a hidden class=anchor aria-hidden=true href=#7index_merge>#</a></h6></li></ul><p>表示查询使用了两个以上的索引，最后取交集或者并集，常见and ，or的条件使用了不同的索引，官方排序这个在ref_or_null之后，但是实际上由于要读取多个索引，性能可能大部分时间都不如range</p><ul><li><h6 id=8unique_subquery>8、unique_subquery<a hidden class=anchor aria-hidden=true href=#8unique_subquery>#</a></h6></li></ul><p>用于where中的in形式子查询，子查询返回不重复值唯一值，可以完全替换子查询，效率更高。
该类型替换了下面形式的IN子查询的ref：
<code>value IN (SELECT primary_key FROM single_table WHERE some_expr)</code></p><ul><li><h6 id=9index_subquery>9、index_subquery<a hidden class=anchor aria-hidden=true href=#9index_subquery>#</a></h6></li></ul><p>该联接类型类似于unique_subquery。适用于非唯一索引，可以返回重复值。</p><ul><li><h6 id=10range>10、range<a hidden class=anchor aria-hidden=true href=#10range>#</a></h6></li></ul><p>索引范围查询，常见于使用 =, &lt;>, >, >=, &lt;, &lt;=, IS NULL, &lt;=>, BETWEEN, IN()或者like等运算符的查询中。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>SELECT <span style=color:#f92672>*</span> FROM tbl_name
</span></span><span style=display:flex><span>  WHERE key_column BETWEEN <span style=color:#ae81ff>10</span> and <span style=color:#ae81ff>20</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SELECT <span style=color:#f92672>*</span> FROM tbl_name
</span></span><span style=display:flex><span>  WHERE key_column <span style=color:#a6e22e>IN</span> (<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>20</span>,<span style=color:#ae81ff>30</span>);
</span></span></code></pre></div><ul><li><h6 id=11index>11、index<a hidden class=anchor aria-hidden=true href=#11index>#</a></h6></li></ul><p>索引全表扫描，把索引从头到尾扫一遍。这里包含两种情况：
一种是查询使用了覆盖索引，那么它只需要扫描索引就可以获得数据，这个效率要比全表扫描要快，因为索引通常比数据表小，而且还能避免二次查询。在extra中显示Using index，反之，如果在索引上进行全表扫描，没有Using index的提示。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#75715e># 此表见有一个name列索引。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 因为查询的列name上建有索引，所以如果这样type走的是index</span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> explain select name from testa;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+-------+---------------+----------+---------+------+------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> select_type <span style=color:#f92672>|</span> table <span style=color:#f92672>|</span> type  <span style=color:#f92672>|</span> possible_keys <span style=color:#f92672>|</span> key      <span style=color:#f92672>|</span> key_len <span style=color:#f92672>|</span> ref  <span style=color:#f92672>|</span> rows <span style=color:#f92672>|</span> <span style=color:#66d9ef>Extra</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+-------+---------------+----------+---------+------+------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>SIMPLE</span>      <span style=color:#f92672>|</span> testa <span style=color:#f92672>|</span> index <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>          <span style=color:#f92672>|</span> idx_name <span style=color:#f92672>|</span> <span style=color:#ae81ff>33</span>      <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Using</span> index <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+-------+---------------+----------+---------+------+------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> set
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 因为查询的列cusno没有建索引，或者查询的列包含没有索引的列，这样查询就会走ALL扫描，如下：</span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> explain select cusno from testa;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> select_type <span style=color:#f92672>|</span> table <span style=color:#f92672>|</span> type <span style=color:#f92672>|</span> possible_keys <span style=color:#f92672>|</span> key  <span style=color:#f92672>|</span> key_len <span style=color:#f92672>|</span> ref  <span style=color:#f92672>|</span> rows <span style=color:#f92672>|</span> <span style=color:#66d9ef>Extra</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>SIMPLE</span>      <span style=color:#f92672>|</span> testa <span style=color:#f92672>|</span> <span style=color:#66d9ef>ALL</span>  <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>          <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> set
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 包含有未见索引的列</span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> explain select <span style=color:#f92672>*</span> from testa;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> select_type <span style=color:#f92672>|</span> table <span style=color:#f92672>|</span> type <span style=color:#f92672>|</span> possible_keys <span style=color:#f92672>|</span> key  <span style=color:#f92672>|</span> key_len <span style=color:#f92672>|</span> ref  <span style=color:#f92672>|</span> rows <span style=color:#f92672>|</span> <span style=color:#66d9ef>Extra</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>SIMPLE</span>      <span style=color:#f92672>|</span> testa <span style=color:#f92672>|</span> <span style=color:#66d9ef>ALL</span>  <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>          <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+-------------+-------+------+---------------+------+---------+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> set
</span></span></code></pre></div><ul><li><h6 id=12all>12、all<a hidden class=anchor aria-hidden=true href=#12all>#</a></h6></li></ul><p>全表扫描，性能最差。</p><h2 id=5-partitions>5. partitions<a hidden class=anchor aria-hidden=true href=#5-partitions>#</a></h2><p>版本5.7以前，该项是explain partitions显示的选项，5.7以后成为了默认选项。该列显示的为分区表命中的分区情况。非分区表该字段为空（null）。</p><h2 id=6-possible_keys>6. possible_keys<a hidden class=anchor aria-hidden=true href=#6-possible_keys>#</a></h2><p>查询可能使用到的索引都会在这里列出来</p><h2 id=7-key>7. key<a hidden class=anchor aria-hidden=true href=#7-key>#</a></h2><p>查询真正使用到的索引。
select_type为index_merge时，这里可能出现两个以上的索引，其他的select_type这里只会出现一个。</p><h2 id=8-key_len>8. key_len<a hidden class=anchor aria-hidden=true href=#8-key_len>#</a></h2><p>查询用到的索引长度（字节数）。
如果是单列索引，那就整个索引长度算进去，如果是多列索引，那么查询不一定都能使用到所有的列，用多少算多少。留意下这个列的值，算一下你的多列索引总长度就知道有没有使用到所有的列了。</p><blockquote><p>key_len只计算<strong>where</strong>条件用到的索引长度，而排序和分组就算用到了索引，也不会计算到key_len中。</p></blockquote><h2 id=9-ref>9. ref<a hidden class=anchor aria-hidden=true href=#9-ref>#</a></h2><p>如果是使用的常数等值查询，这里会显示const，如果是连接查询，被驱动表的执行计划这里会显示驱动表的关联字段，如果是条件使用了表达式或者函数，或者条件列发生了内部隐式转换，这里可能显示为func</p><h2 id=10-rows重要>10. rows（重要）<a hidden class=anchor aria-hidden=true href=#10-rows重要>#</a></h2><p><strong>rows 也是一个重要的字段</strong>。 这是mysql估算的需要扫描的行数（不是精确值）。
这个值非常直观显示 SQL 的效率好坏, 原则上 rows 越少越好.</p><h2 id=11-filtered>11. filtered<a hidden class=anchor aria-hidden=true href=#11-filtered>#</a></h2><p>这个字段表示存储引擎返回的数据在server层过滤后，剩下多少满足查询的记录数量的比例，注意是百分比，不是具体记录数。这个字段不重要</p><h2 id=12-extra重要>12. extra（重要）<a hidden class=anchor aria-hidden=true href=#12-extra重要>#</a></h2><p>EXplain 中的很多额外的信息会在 Extra 字段显示, 常见的有以下几种内容:</p><ul><li><strong>distinct</strong>：在select部分使用了distinc关键字</li><li><strong>Using filesort</strong>：当 Extra 中有 Using filesort 时, 表示 MySQL 需额外的排序操作, 不能通过索引顺序达到排序效果. 一般有 Using filesort, 都建议优化去掉, 因为这样的查询 CPU 资源消耗大.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objectivec data-lang=objectivec><span style=display:flex><span><span style=color:#75715e># 例如下面的例子:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> EXPLAIN SELECT <span style=color:#f92672>*</span> FROM order_info ORDER BY product_name <span style=color:#960050;background-color:#1e0010>\</span>G
</span></span><span style=display:flex><span><span style=color:#f92672>***************************</span> <span style=color:#ae81ff>1.</span> row <span style=color:#f92672>***************************</span>
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  select_type: SIMPLE
</span></span><span style=display:flex><span>        table: order_info
</span></span><span style=display:flex><span>   partitions: NULL
</span></span><span style=display:flex><span>         type: index
</span></span><span style=display:flex><span>possible_keys: NULL
</span></span><span style=display:flex><span>          key: user_product_detail_index
</span></span><span style=display:flex><span>      key_len: <span style=color:#ae81ff>253</span>
</span></span><span style=display:flex><span>          ref: NULL
</span></span><span style=display:flex><span>         rows: <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>     filtered: <span style=color:#ae81ff>100.00</span>
</span></span><span style=display:flex><span>        Extra: Using index; Using filesort
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> set, <span style=color:#ae81ff>1</span> warning (<span style=color:#ae81ff>0.00</span> sec)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>我们的索引是</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>KEY <span style=color:#960050;background-color:#1e0010>`</span>user_product_detail_index<span style=color:#960050;background-color:#1e0010>`</span> (<span style=color:#960050;background-color:#1e0010>`</span>user_id<span style=color:#960050;background-color:#1e0010>`</span>, <span style=color:#960050;background-color:#1e0010>`</span>product_name<span style=color:#960050;background-color:#1e0010>`</span>, <span style=color:#960050;background-color:#1e0010>`</span>productor<span style=color:#960050;background-color:#1e0010>`</span>)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>但是上面的查询中根据</span> product_name <span style=color:#960050;background-color:#1e0010>来排序</span>, <span style=color:#960050;background-color:#1e0010>因此不能使用索引进行优化</span>, <span style=color:#960050;background-color:#1e0010>进而会产生</span> Using filesort.
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>如果我们将排序依据改为</span> ORDER BY user_id, product_name, <span style=color:#960050;background-color:#1e0010>那么就不会出现</span> Using filesort <span style=color:#960050;background-color:#1e0010>了</span>. <span style=color:#960050;background-color:#1e0010>例如</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> EXPLAIN SELECT <span style=color:#f92672>*</span> FROM order_info ORDER BY user_id, product_name <span style=color:#960050;background-color:#1e0010>\</span>G
</span></span><span style=display:flex><span><span style=color:#f92672>***************************</span> <span style=color:#ae81ff>1.</span> row <span style=color:#f92672>***************************</span>
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>id</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  select_type: SIMPLE
</span></span><span style=display:flex><span>        table: order_info
</span></span><span style=display:flex><span>   partitions: NULL
</span></span><span style=display:flex><span>         type: index
</span></span><span style=display:flex><span>possible_keys: NULL
</span></span><span style=display:flex><span>          key: user_product_detail_index
</span></span><span style=display:flex><span>      key_len: <span style=color:#ae81ff>253</span>
</span></span><span style=display:flex><span>          ref: NULL
</span></span><span style=display:flex><span>         rows: <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>     filtered: <span style=color:#ae81ff>100.00</span>
</span></span><span style=display:flex><span>        Extra: Using index
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> set, <span style=color:#ae81ff>1</span> warning (<span style=color:#ae81ff>0.00</span> sec)
</span></span></code></pre></div><ul><li><strong>Using index</strong>
&ldquo;覆盖索引扫描&rdquo;, 表示查询在索引树中就可查找所需数据, 不用扫描表数据文件, 往往说明<strong>性能不错</strong></li><li><strong>Using temporary</strong>
查询有使用临时表, 一般出现于排序, 分组和多表 join 的情况, 查询效率不高, 建议优化.</li></ul><p>除此之外还有其他值，这里就不一一一列举了。</p><hr><p>通过以上这些总结，以后我们看到explain的结果，就知道该从哪些字段值去分析sql语句的执行效率了。</p><div class=post-meta></hr>注：本作品采用<a rel=license target=view_window href=http://creativecommons.org/licenses/by-nc-sa/4.0/> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议 </a>进行许可。</div></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.swimminghao.top/tags/mysql/>🏷 mysql</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share explain结果每个字段的含义说明 on twitter" href="https://twitter.com/intent/tweet/?text=explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e&url=https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f&hashtags=mysql"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share explain结果每个字段的含义说明 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f&title=explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e&summary=explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e&source=https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share explain结果每个字段的含义说明 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f&title=explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share explain结果每个字段的含义说明 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share explain结果每个字段的含义说明 on whatsapp" href="https://api.whatsapp.com/send?text=explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e%20-%20https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share explain结果每个字段的含义说明 on telegram" href="https://telegram.me/share/url?text=explain%e7%bb%93%e6%9e%9c%e6%af%8f%e4%b8%aa%e5%ad%97%e6%ae%b5%e7%9a%84%e5%90%ab%e4%b9%89%e8%af%b4%e6%98%8e&url=https%3a%2f%2fwww.swimminghao.top%2fpost%2f02%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25AD%25A6%25E4%25B9%25A0%2f10_01_sql%2fsql%2fexplain%25E7%25BB%2593%25E6%259E%259C%25E6%25AF%258F%25E4%25B8%25AA%25E5%25AD%2597%25E6%25AE%25B5%25E7%259A%2584%25E5%2590%25AB%25E4%25B9%2589%25E8%25AF%25B4%25E6%2598%258E%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div><nav class=paginav><a class=prev href=https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/05_01_docker/docker/dockerfile/><span class=title>« 上一页</span><br><span>Dockerfile</span></a>
<a class=next href=https://www.swimminghao.top/post/02%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/04_01_git/git/git-reset%E6%94%BE%E5%BC%83%E4%BF%AE%E6%94%B9%E6%94%BE%E5%BC%83%E5%A2%9E%E5%8A%A0%E6%96%87%E4%BB%B6/><span class=title>下一页 »</span><br><span>git reset放弃修改&放弃增加文件</span></a></nav></footer></article></main><footer class=footer><span>Copyright &copy; 2023 • <a href=https://www.swimminghao.top/>swimminghao</a></span><div><span><a href=/about/>关于</a>
• <a href=/disclaimer/>免责声明</a>
• <a href=/sitemap.xml target=view_window>站点地图</a>
• <a href=https://www.foreverblog.cn/go.html target=view_window>虫洞</a>
• PV <span id=busuanzi_value_site_pv><i class="fa fa-spinner fa-spin"></i></span></span></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><meta name=”apple-mobile-web-app-capable” content="”yes”"><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js")})</script></body></html>